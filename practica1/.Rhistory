u <- function (x,y) (c(-y,-x,0)/( ((x^2)+(y^2))^(3/2) )
u(1,1)
u <- function (x,y) (c(-y,-x,0)/( ((x^2)+(y^2))^(3/2) )
u(1,1)
u <- function (x,y) (c(-y,-x,0)/( ((x^2)+(y^2))^(3/2) )
u <- function (x,y) c(-y,-x,0)/( ((x^2)+(y^2))^(3/2) )
u(1,1)
u <- function (x,y) c(-y,-x,0)/( ((x^2)+(y^2))^(3/2) )
u <- function (x,y) c(-y,-x,0)/( ((x^2)+(y^2))^(3/2) )
u(1,1)
hx <- 0.1; hy<- 0.1; kz<-0.1
dUz_dy <- function(X,Y) (u(X,Y,Z+hz)-u(X,Y,Z-hz))/(2*hy)
u <- function (x,y,z) c(-y,-x,0)/( ((x^2)+(y^2))^(3/2) )
u <- function (x,y,z) c(-y,-x,0)/( ((x^2)+(y^2))^(3/2) )
u(1,1,1)
hx <- 0.1; hy<- 0.1; hz<-0.1
h<-c(hx,hy,hz)
duj_di <- function(X,Y,Z,j,i) (u(X,Y,Z+hz)[j]-u(X,Y,Z-hz)[j])/(2*h[i])
DeltaXu<-function(X,Y,Z) c( duj_di(X,Y,Z,3,2)-duj_di(X,Y,Z,2,3), duj_di(X,Y,Z,1,3)-duj_di(X,Y,Z,3,1), duj_di(X,Y,Z,2,1)-duj_di(X,Y,Z,1,2) )
X<-seq(-2,2,by=0.1)
Y<-X
XY <- expand.grid(X,Y)
plot(0,0,xlim=c(-2,2), ylim=c(-2,2), type="n")
duj_di(XY[,1],XY[,2],0)
Z<-rep(0,length(X))
XY <- expand.grid(X,Y,Z)
XYZ <- expand.grid(X,Y,Z)
XYZ
u <- function (x,y) c(-y,-x,0)/( ((x^2)+(y^2))^(3/2) )
u <- function (x,y,z) c(-y,-x,0)/( ((x^2)+(y^2))^(3/2) )
duj_di <- function(X,Y,Z,j,i) (u(X,Y,Z+hz)[j]-u(X,Y,Z-hz)[j])/(2*h[i])
DeltaXu<-function(X,Y,Z) c( duj_di(X,Y,Z,3,2)-duj_di(X,Y,Z,2,3), duj_di(X,Y,Z,1,3)-duj_di(X,Y,Z,3,1), duj_di(X,Y,Z,2,1)-duj_di(X,Y,Z,1,2) )
plot(0,0,xlim=c(-2,2), ylim=c(-2,2), type="n")
install.packages("plot3D")
library("plot3D", lib.loc="~/R/x86_64-pc-linux-gnu-library/3.1")
plot(0,0,xlim=c(-2,2), ylim=c(-2,2), type="n")
plot(0,0,xlim=c(-2,2), ylim=c(-2,2), type="n")
persp3D(0,0,0,xlim=c(-2,2), ylim=c(-2,2), type="n")
plot(0,0,xlim=c(-2,2), ylim=c(-2,2), type="n")
dux_dz <- function(X,Y,Z) (u(X,Y,Z+hz)[1]-u(X,Y,Z-hz)[1])/(2*hz)
dux_dz <- function(X,Y,Z) (u(X,Y,Z+hz)[1]-u(X,Y,Z-hz)[1])/(2*hz)
dux_dy <- function(X,Y,Z) (u(X,Y+hy,Z)[1]-u(X,Y-hy,Z)[1])/(2*hy)
dux_dx <- function(X,Y,Z) (u(X+hx,Y,Z)[1]-u(X-hx,Y,Z)[1])/(2*hx)
duy_dz <- function(X,Y,Z) (u(X,Y,Z+hz)[2]-u(X,Y,Z-hz)[2])/(2*hz)
duy_dy <- function(X,Y,Z) (u(X,Y+hy,Z)[2]-u(X,Y-hy,Z)[2])/(2*hy)
duy_dx <- function(X,Y,Z) (u(X+hx,Y,Z)[2]-u(X-hx,Y,Z)[2])/(2*hx)
duz_dz <- function(X,Y,Z) (u(X,Y,Z+hz)[3]-u(X,Y,Z-hz)[3])/(2*hz)
duz_dy <- function(X,Y,Z) (u(X,Y+hy,Z)[3]-u(X,Y-hy,Z)[3])/(2*hy)
duz_dx <- function(X,Y,Z) (u(X+hx,Y,Z)[3]-u(X-hx,Y,Z)[3])/(2*hx)
DeltaXu<-function(X,Y,Z) c( dux_dy(X,Y,Z)-duy_dz(X,Y,Z), dux_dz(X,Y,Z)-duz_dx(X,Y,Z), duy_dx(X,Y,Z)-dux_dy(X,Y,Z) )
XYZOut<-outer(X,Y,Z,DeltaXu)
Z<-rep(0,length(X))
X<-seq(-2,2,by=0.1)
Y<-X
DeltaXu<-function(X,Y,Z) c( dux_dy(X,Y,Z)-duy_dz(X,Y,Z), dux_dz(X,Y,Z)-duz_dx(X,Y,Z), duy_dx(X,Y,Z)-dux_dy(X,Y,Z) )
XYZ <- expand.grid(X,Y,Z)
XYZOut<-outer(X,Y,Z,DeltaXu)
XYZOut<-DeltaXu(X,Y,Z)
XYZOut
X<-seq(-2,2,by=0.1)
Y<-X
Z<-rep(0,length(X))
XYZOut<-DeltaXu(X,Y,Z)
DeltaXu(X,Y,Z)
XYZOut<-DeltaXu(XYZ[,1],XYZ[,2],XYZ[,3])
DeltaXu(XYZ[,1],XYZ[,2],XYZ[,3])
df_dx(XY[,1],XY[,2])
DeltaXu(XYZ[,1],XYZ[,2],XYZ[,3])
warnings()
Z<-X
XYZ <- expand.grid(X,Y,Z)
XYZOut<-DeltaXu(XYZ[,1],XYZ[,2],XYZ[,3])
warnings()
u <- function (x,y,z) c(-y,-x,0)/( ((x^2)+(y^2))^(3/2) )
XYZOut<-DeltaXu(XYZ[,1],XYZ[,2],XYZ[,3])
warnings()
u(XYZ[,1],XYZ[,2],XYZ[,3])
length(XYZOut)
length(XYZ)
dim(XYZ)
X<-seq(-2,2,by=0.5)
Y<-X
Z<-X
XYZ <- expand.grid(X,Y,Z)
XYZ
XYZOut<-DeltaXu(XYZ[,1],XYZ[,2],XYZ[,3])
u(XYZ[,1],XYZ[,2],XYZ[,3])
persp(u(XYZ[,1],XYZ[,2],XYZ[,3]))
X<-seq(-2,2,by=0.5)
Y<-X
Z<-X
XYZ <- expand.grid(X,Y,Z)
XYZ
DeltaXu(XYZ[,1],XYZ[,2],XYZ[,3])
persp(u(XYZ[,1],XYZ[,2],XYZ[,3]))
u(XYZ[,1],XYZ[,2],XYZ[,3])
DeltaXu(XYZ[,1],XYZ[,2],XYZ[,3])
dim(XYZ)
XYZOut<-matrix(NA, ncol=3,nrow=0)
dim(XYZ)
for (i in 1:dim(XYZ)[1]){
XYZOut<-rbind(XYZOut,DeltaXu(XYZ[i,1],XYZ[i,2],XYZ[i,3]))
}
XYZOut
XYZ
XYZ[,1]-XYZOut[,1]
arrows3D(x0=XYZ[,1],y0=XYZ[,2],z0=XYZ[,3], x1=(XYZ[,1]-XYZOut[,1]),y1=(XYZ[,2]-XYZOut[,2]), z1=(XYZ[,3]-XYZOut[,3]) )
persp(u(XYZ[,1],XYZ[,2],XYZ[,3]))
XYZ[,3]-XYZOut[,3]
XYZ[,2]-XYZOut[,2]
arrows3D(x0=XYZ[,1],y0=XYZ[,2],z0=XYZ[,3], x1=XYZ[,1],y1=XYZ[,2],z3=XYZ[,3])
arrows3D(x0=XYZ[,1],y0=XYZ[,2],z0=XYZ[,3], x1=(XYZ[,1]+XYZOut[,1]),y1=XYZ[,2],z3=XYZ[,3])
arrows3D(x0=XYZ[,1],y0=XYZ[,2],z0=XYZ[,3], x1=(XYZ[,1]+XYZOut[,1]),y1=XYZ[,2]+XYZOut[,2],z3=XYZ[,3])
arrows3D(x0=XYZ[,1],y0=XYZ[,2],z0=XYZ[,3], x1=(XYZ[,1]+XYZOut[,1]),y1=XYZ[,2]+XYZOut[,2],z3=XYZ[,3]+XYZOut[,3])
arrows3D(x0=XYZ[,1],y0=XYZ[,2],z0=XYZ[,3], x1=(XYZ[,1]+XYZOut[,1]),y1=XYZ[,2]+XYZOut[,2],z3=XYZ[,3]+XYZOut[,3])
arrows3D(x0=XYZ[,1],y0=XYZ[,2],z0=XYZ[,3], x1=(XYZ[,1]+XYZOut[,1]),y1=XYZ[,2]+XYZOut[,2],z1=XYZ[,3]+XYZOut[,3])
XYZIn<-matrix(NA, ncol=3,nrow=0)
XYZOut<-matrix(NA, ncol=3,nrow=0)
XYZIn<-matrix(NA, ncol=3,nrow=0)
for (i in 1:dim(XYZ)[1]){
XYZOut<-rbind(XYZOut,DeltaXu(XYZ[i,1],XYZ[i,2],XYZ[i,3]))
XYZIn<-rbind(XYZOut,u(XYZ[i,1],XYZ[i,2],XYZ[i,3]))
}
XYZIn
arrows3D(x0=XYZIn[,1],y0=XYZIn[,2],z0=XYZIn[,3], x1=(XYZIn[,1]),y1=XYZIn[,2],z1=XYZIn[,3])
arrows3D(x0=XYZIn[,1],y0=XYZIn[,2],z0=XYZIn[,3], x1=(XYZIn[,1]),y1=XYZIn[,2],z1=XYZIn[,3])
arrows3D(x0=XYZIn[,1],y0=XYZIn[,2],z0=XYZIn[,3], x1=(XYZIn[,1]+XYZOut[,1]),y1=XYZIn[,2],z1=XYZIn[,3])
arrows3D(x0=XYZIn[,1],y0=XYZIn[,2],z0=XYZIn[,3], x1=(XYZIn[,1]+XYZOut[,1]),y1=XYZIn[,2]+XYZOut[,2],z1=XYZIn[,3])
arrows3D(x0=XYZIn[,1],y0=XYZIn[,2],z0=XYZIn[,3], x1=(XYZIn[,1]+XYZOut[,1]),y1=XYZIn[,2]+XYZOut[,2],z1=XYZIn[,3]++XYZOut[,3])
arrows3D(x0=XYZIn[,1],y0=XYZIn[,2],z0=XYZIn[,3], x1=(XYZIn[,1]+XYZOut[,1]),y1=XYZIn[,2]+XYZOut[,2],z1=XYZIn[,3]+XYZOut[,3])
arrows3D(x0=XYZIn[,1],y0=XYZIn[,2],z0=XYZIn[,3], x1=(XYZIn[,1]+XYZOut[,1]),y1=XYZIn[,2]+XYZOut[,2],z1=XYZIn[,3]+XYZOut[,3])
XYZIn[,3]+XYZOut[,3]
XYZIn
\end{subfigure}
hx <- 0.1; hy<- 0.1; hz<-0.1
h<-c(hx,hy,hz)
u <- function (x,y,z) c(-y,-x,0)/( ((x^2)+(y^2))^(3/2) )
dux_dz <- function(X,Y,Z) (u(X,Y,Z+hz)[1]-u(X,Y,Z-hz)[1])/(2*hz)
dux_dy <- function(X,Y,Z) (u(X,Y+hy,Z)[1]-u(X,Y-hy,Z)[1])/(2*hy)
dux_dx <- function(X,Y,Z) (u(X+hx,Y,Z)[1]-u(X-hx,Y,Z)[1])/(2*hx)
duy_dz <- function(X,Y,Z) (u(X,Y,Z+hz)[2]-u(X,Y,Z-hz)[2])/(2*hz)
duy_dy <- function(X,Y,Z) (u(X,Y+hy,Z)[2]-u(X,Y-hy,Z)[2])/(2*hy)
duy_dx <- function(X,Y,Z) (u(X+hx,Y,Z)[2]-u(X-hx,Y,Z)[2])/(2*hx)
duz_dz <- function(X,Y,Z) (u(X,Y,Z+hz)[3]-u(X,Y,Z-hz)[3])/(2*hz)
duz_dy <- function(X,Y,Z) (u(X,Y+hy,Z)[3]-u(X,Y-hy,Z)[3])/(2*hy)
duz_dx <- function(X,Y,Z) (u(X+hx,Y,Z)[3]-u(X-hx,Y,Z)[3])/(2*hx)
DeltaXu<-function(X,Y,Z) c( dux_dy(X,Y,Z)-duy_dz(X,Y,Z), dux_dz(X,Y,Z)-duz_dx(X,Y,Z), duy_dx(X,Y,Z)-dux_dy(X,Y,Z) )
X1<-seq(-2,2,by=0.5); Y1<-X; Z1<-X;
XYZ <- expand.grid(X1,Y1,Z1);
X<-as.matrix(XYZ[,1]); Y<-as.matrix(XYZ[,2]); Z<-as.matrix(XYZ[,3])
RotorX<-matrix(NA, ncol=1,nrow=0)
RotorY<-matrix(NA, ncol=1,nrow=0)
RotorZ<-matrix(NA, ncol=1,nrow=0)
for (i in 1:dim(XYZ)[1]){
res <- DeltaXu(X[i],Y[i],Z[i])
RotorX<-rbind(RotorX,res[1])
RotorY<-rbind(RotorY,res[2])
RotorZ<-rbind(RotorZ,res[3])
}
sinNa<-(!is.na(RotorX))&(!is.na(RotorY))&(!is.na(RotorZ))
arrows3D(x0=X[sinNa],y0=Y[sinNa],z0=Z[sinNa], x1=(X+(RotorX/100))[sinNa],y1=(Y+(RotorY/100))[sinNa],z1=(Z+(RotorZ/100))[sinNa], theta=0,phi=0, lwd = 2, d = 2, length = 0.1,ticktype="detailed", expand=1, angle=10)
require(grDevices)
require(fields) # para label color
library(plot3D) # extensiÃ³n de persp
library(misc3d)
arrows3D(x0=X[sinNa],y0=Y[sinNa],z0=Z[sinNa], x1=(X+(RotorX/100))[sinNa],y1=(Y+(RotorY/100))[sinNa],z1=(Z+(RotorZ/100))[sinNa], theta=0,phi=0, lwd = 2, d = 2, length = 0.1,ticktype="detailed", expand=1, angle=10)
arrows3D(x0=X[sinNa],y0=Y[sinNa],z0=Z[sinNa], x1=(X+(RotorX/50))[sinNa],y1=(Y+(RotorY/50))[sinNa],z1=(Z+(RotorZ/50))[sinNa], theta=0,phi=0, lwd = 2, d = 2, length = 0.1,ticktype="detailed", expand=1, angle=10)
arrows3D(x0=X[sinNa],y0=Y[sinNa],z0=Z[sinNa], x1=(X+(RotorX/20))[sinNa],y1=(Y+(RotorY/20))[sinNa],z1=(Z+(RotorZ/20))[sinNa], theta=0,phi=0, lwd = 2, d = 2, length = 0.1,ticktype="detailed", expand=1, angle=10)
png('Imagenes/Ej4_Rotor_XZ.png')
arrows3D(x0=X[sinNa],y0=Y[sinNa],z0=Z[sinNa], x1=(X+(RotorX/20))[sinNa],y1=(Y+(RotorY/20))[sinNa],z1=(Z+(RotorZ/20))[sinNa], theta=0,phi=0, lwd = 2, d = 2, length = 0.1,ticktype="detailed", expand=1, angle=10)
graphics.off()
png('Imagenes/Ej4_Rotor_YZ.png')
arrows3D(x0=X[sinNa],y0=Y[sinNa],z0=Z[sinNa], x1=(X+(RotorX/20))[sinNa],y1=(Y+(RotorY/20))[sinNa],z1=(Z+(RotorZ/20))[sinNa], theta=90,phi=0, lwd = 2, d = 2, length = 0.1,ticktype="detailed", expand=1, angle=10)
graphics.off()
png('Imagenes/Ej4_Rotor_XY.png')
arrows3D(x0=X[sinNa],y0=Y[sinNa],z0=Z[sinNa], x1=(X+(RotorX/20))[sinNa],y1=(Y+(RotorY/20))[sinNa],z1=(Z+(RotorZ/20))[sinNa], theta=0,phi=270, lwd = 2, d = 2, length = 0.1,ticktype="detailed", expand=1, angle=10)
graphics.off()
png('Imagenes/Ej4_Rotor.png', width = 480*2, height = 480*2)
arrows3D(x0=X[sinNa],y0=Y[sinNa],z0=Z[sinNa], x1=(X+(RotorX/20))[sinNa],y1=(Y+(RotorY/20))[sinNa],z1=(Z+(RotorZ/20))[sinNa], theta=0,phi=10, lwd = 4, d = 2, length = 0.2,ticktype="detailed", expand=1, angle=20)
graphics.off()
